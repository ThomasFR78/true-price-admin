<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>True Price Authority - Le barom√®tre de confiance des revendeurs de cl√©s</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#00b67a',
                        secondary: '#1a1a2e',
                        accent: '#ff6b35',
                        danger: '#dc2626',
                        warning: '#f59e0b'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-hero { background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); }
        .trust-ring {
            background: conic-gradient(#00b67a var(--percent), #e5e7eb var(--percent));
            border-radius: 50%;
        }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 12px 40px rgba(0,0,0,0.12); }
        .badge-honest { background: linear-gradient(135deg, #00b67a, #059669); }
        .badge-reliable { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .badge-correct { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .badge-warning { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .lie-meter { background: linear-gradient(90deg, #00b67a 0%, #84cc16 25%, #facc15 50%, #f97316 75%, #ef4444 100%); }
    </style>
</head>
<body class="bg-white text-gray-900">
    <div id="root"></div>
    <script type="text/babel">
const { useState, useEffect } = React;

// ===== MODE DEMO (partag√© avec CI) =====
function isDemoMode() {
    return localStorage.getItem('ci_demo_mode') === 'true';
}

// Donn√©es d√©mo pour TPA
const DEMO_OFFERS = [
    { id: 'demo-1', name: 'GTA VI', source: 'CDKeys', displayed_price: 54.99, created_at: '2026-01-30T10:00:00Z' },
    { id: 'demo-2', name: 'GTA VI', source: 'Instant Gaming', displayed_price: 52.99, created_at: '2026-01-30T10:00:00Z' },
    { id: 'demo-3', name: 'GTA VI', source: 'G2A', displayed_price: 49.99, created_at: '2026-01-30T10:00:00Z' },
    { id: 'demo-4', name: 'EA FC 25', source: 'Eneba', displayed_price: 44.99, created_at: '2026-01-29T10:00:00Z' },
    { id: 'demo-5', name: 'EA FC 25', source: 'Kinguin', displayed_price: 42.50, created_at: '2026-01-29T10:00:00Z' },
    { id: 'demo-6', name: 'Elden Ring', source: 'Fanatical', displayed_price: 34.99, created_at: '2026-01-28T10:00:00Z' },
    { id: 'demo-7', name: 'Elden Ring', source: 'GG.deals', displayed_price: 32.99, created_at: '2026-01-28T10:00:00Z' },
];

const DEMO_CHECKS = [
    { id: 'dc-1', offer_id: 'demo-1', checkout_price: 54.99, check_date: '2026-01-30T12:00:00Z', notes: 'Prix exact' },
    { id: 'dc-2', offer_id: 'demo-2', checkout_price: 55.49, check_date: '2026-01-30T12:00:00Z', notes: '+2.50‚Ç¨ frais cach√©s' },
    { id: 'dc-3', offer_id: 'demo-3', checkout_price: 56.99, check_date: '2026-01-30T12:00:00Z', notes: '+7‚Ç¨ fees' },
    { id: 'dc-4', offer_id: 'demo-4', checkout_price: 44.99, check_date: '2026-01-29T12:00:00Z', notes: 'Prix correct' },
    { id: 'dc-5', offer_id: 'demo-5', checkout_price: 47.80, check_date: '2026-01-29T12:00:00Z', notes: '+5.30‚Ç¨ premium' },
    { id: 'dc-6', offer_id: 'demo-6', checkout_price: 34.99, check_date: '2026-01-28T12:00:00Z', notes: 'Honn√™te' },
    { id: 'dc-7', offer_id: 'demo-7', checkout_price: 32.99, check_date: '2026-01-28T12:00:00Z', notes: 'Prix v√©rifi√©' },
];

const DEMO_COUPONS = [
    { id: 'coupon-1', code: 'DEMO10', source: 'G2A', discount: '10%', is_fake: false, tested_at: '2026-01-30T10:00:00Z' },
    { id: 'coupon-2', code: 'SAVE20', source: 'Kinguin', discount: '20%', is_fake: true, tested_at: '2026-01-29T10:00:00Z' },
    { id: 'coupon-3', code: 'WINTER5', source: 'CDKeys', discount: '5%', is_fake: false, tested_at: '2026-01-28T10:00:00Z' },
];

// ===== CONFIG SUPABASE =====
const SUPABASE_URL = 'https://ngzvurmhqnanoghjyswh.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nenZ1cm1ocW5hbm9naGp5c3doIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1OTc2MTIsImV4cCI6MjA4NDE3MzYxMn0.Sk9M-tUkZY5p0OPw7xT0UOaIgOR3SQRACSVyi_TL61Q';

// Logos par d√©faut pour les sources connues
const SOURCE_LOGOS = {
    'AllKeyShop': 'üîµ', 'GG.deals': 'üü¢', 'IsThereAnyDeal': 'üü°', 'Idealo': 'üü†', 'DLCompare': 'üî¥', 'CheapShark': 'ü¶à',
    'CDKeys': 'üîë', 'Gamesplanet': 'üåç', 'Fanatical': 'üéØ', 'Instant Gaming': '‚ö°', 'Eneba': 'üõí', 'G2A': 'üè™', 'Kinguin': 'üëë',
    'Gamivo': 'üé™', 'HRK': 'üéÆ', 'Green Man Gaming': 'üü©', 'Humble': 'üì¶', 'GOG': 'üéÅ'
};

// ===== TRADUCTIONS FR/EN =====
const TRANSLATIONS = {
    fr: {
        // Navigation
        home: 'Accueil', rankings: 'Classement', scams: 'Arnaques', fakeCoupons: 'Faux Coupons', about: '√Ä propos',
        // Hero
        heroTagline: 'V√©rification des prix depuis',
        heroTitle1: 'Arr√™tez de vous faire avoir sur les',
        heroTitle2: 'prix des cl√©s de jeux',
        heroDesc: 'True Price Authority v√©rifie les prix r√©els des revendeurs de cl√©s. Nous exposons les frais cach√©s, les faux coupons et les pratiques trompeuses.',
        viewRankings: 'Voir le classement', exposedOffers: 'Offres expos√©es',
        // Lie Barometer
        lieBarometer: 'Barom√®tre du Mensonge', lieDesc: 'Taux moyen d\'√©cart prix affich√© vs r√©el', lying: 'de mensonge',
        honest: 'Honn√™te', deceiving: 'Trompeur',
        // Stats
        pricesVerified: 'Prix v√©rifi√©s', vendorsAudited: 'Vendeurs audit√©s', scamsExposed: 'Arnaques expos√©es',
        fakeCouponsCount: 'Faux coupons', avgReliability: 'Taux de fiabilit√© moyen',
        // Rankings
        trustRanking: 'Classement de Confiance', basedOn: 'Bas√© sur', priceChecks: 'v√©rifications de prix',
        compareDesc: 'Nous comparons le prix affich√© sur les comparateurs avec le prix r√©el au checkout.',
        viewFullRanking: 'Voir le classement complet', avgDiff: '√âcart moyen', checks: 'v√©rifs',
        // Scams
        recentScams: 'Derni√®res Arnaques Expos√©es', scamsDesc: 'Prix trompeurs d√©tect√©s ces derniers jours',
        viewAllScams: 'Voir toutes les arnaques', hiddenFees: 'Frais cach√©s', realPrice: 'Prix r√©el',
        // How it works
        howItWorks: 'Comment √ßa marche ?', methodology: 'Notre m√©thodologie de v√©rification',
        step1: 'Collecte', step1Desc: 'Nous relevons les prix affich√©s sur Allkeyshop et GG.deals',
        step2: 'V√©rification', step2Desc: 'Nous allons jusqu\'au checkout sur chaque marchand',
        step3: 'Comparaison', step3Desc: 'Nous calculons l\'√©cart entre prix affich√© et prix r√©el',
        step4: 'Publication', step4Desc: 'Nous publions les r√©sultats et alertons la communaut√©',
        // Badges
        reference: 'R√âF√âRENCE', veryReliable: 'TR√àS FIABLE', reliable: 'FIABLE', variable: 'VARIABLE', caution: 'ATTENTION', risky: 'RISQU√â',
        // Footer
        footerDesc: 'Le barom√®tre de confiance des revendeurs de cl√©s de jeux. Nous v√©rifions les prix r√©els pour vous prot√©ger.',
        notAffiliated: 'Non affili√© aux revendeurs audit√©s.', lastUpdate: 'Derni√®re mise √† jour',
        // Misc
        demoMode: 'MODE D√âMO', comparators: 'Comparateurs', merchants: 'Marchands'
    },
    en: {
        // Navigation
        home: 'Home', rankings: 'Rankings', scams: 'Scams', fakeCoupons: 'Fake Coupons', about: 'About',
        // Hero
        heroTagline: 'Price verification since',
        heroTitle1: 'Stop getting ripped off on',
        heroTitle2: 'game key prices',
        heroDesc: 'True Price Authority verifies real prices from key resellers. We expose hidden fees, fake coupons and deceptive practices.',
        viewRankings: 'View rankings', exposedOffers: 'Exposed offers',
        // Lie Barometer
        lieBarometer: 'Lie Barometer', lieDesc: 'Average gap between displayed and real price', lying: 'of lies',
        honest: 'Honest', deceiving: 'Deceiving',
        // Stats
        pricesVerified: 'Prices verified', vendorsAudited: 'Vendors audited', scamsExposed: 'Scams exposed',
        fakeCouponsCount: 'Fake coupons', avgReliability: 'Average reliability rate',
        // Rankings
        trustRanking: 'Trust Ranking', basedOn: 'Based on', priceChecks: 'price checks',
        compareDesc: 'We compare the displayed price on comparators with the real checkout price.',
        viewFullRanking: 'View full ranking', avgDiff: 'Avg. difference', checks: 'checks',
        // Scams
        recentScams: 'Recent Scams Exposed', scamsDesc: 'Deceptive prices detected recently',
        viewAllScams: 'View all scams', hiddenFees: 'Hidden fees', realPrice: 'Real price',
        // How it works
        howItWorks: 'How it works?', methodology: 'Our verification methodology',
        step1: 'Collection', step1Desc: 'We collect displayed prices from Allkeyshop and GG.deals',
        step2: 'Verification', step2Desc: 'We go to checkout on each merchant',
        step3: 'Comparison', step3Desc: 'We calculate the gap between displayed and real price',
        step4: 'Publication', step4Desc: 'We publish results and alert the community',
        // Badges
        reference: 'REFERENCE', veryReliable: 'VERY RELIABLE', reliable: 'RELIABLE', variable: 'VARIABLE', caution: 'CAUTION', risky: 'RISKY',
        // Footer
        footerDesc: 'The trust barometer for game key resellers. We verify real prices to protect you.',
        notAffiliated: 'Not affiliated with audited resellers.', lastUpdate: 'Last update',
        // Misc
        demoMode: 'DEMO MODE', comparators: 'Comparators', merchants: 'Merchants'
    }
};

// Contexte de langue global
const LangContext = React.createContext({ lang: 'fr', setLang: () => {}, t: (key) => key });

function useLang() {
    return React.useContext(LangContext);
}

// ===== COMPOSANTS =====
function App() {
    const [currentPage, setCurrentPage] = useState('home');
    const [loading, setLoading] = useState(true);
    const [rawOffers, setRawOffers] = useState([]);
    const [rawChecks, setRawChecks] = useState([]);
    const [rawCoupons, setRawCoupons] = useState([]);
    const [lang, setLang] = useState(() => localStorage.getItem('tpa_lang') || 'fr');

    // Fonction de traduction
    const t = (key) => TRANSLATIONS[lang]?.[key] || TRANSLATIONS['fr'][key] || key;

    // Sauvegarder la langue
    useEffect(() => { localStorage.setItem('tpa_lang', lang); }, [lang]);

    // Charger les donn√©es depuis Supabase ou mode d√©mo
    useEffect(() => {
        const loadData = async () => {
            // Mode d√©mo : utiliser les donn√©es de test
            if (isDemoMode()) {
                setRawOffers(DEMO_OFFERS);
                setRawChecks(DEMO_CHECKS);
                setRawCoupons(DEMO_COUPONS);
                setLoading(false);
                return;
            }

            // Mode r√©el : charger depuis Supabase
            try {
                const [offersRes, checksRes, couponsRes] = await Promise.all([
                    fetch(`${SUPABASE_URL}/rest/v1/offers?select=*`, {
                        headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${SUPABASE_KEY}` }
                    }),
                    fetch(`${SUPABASE_URL}/rest/v1/price_checks?select=*`, {
                        headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${SUPABASE_KEY}` }
                    }),
                    fetch(`${SUPABASE_URL}/rest/v1/coupons?select=*`, {
                        headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${SUPABASE_KEY}` }
                    })
                ]);
                if (offersRes.ok && checksRes.ok) {
                    setRawOffers(await offersRes.json());
                    setRawChecks(await checksRes.json());
                }
                if (couponsRes.ok) {
                    setRawCoupons(await couponsRes.json());
                }
            } catch (e) { console.error('Erreur chargement:', e); }
            setLoading(false);
        };
        loadData();
    }, []);

    // Calculer les donn√©es d√©riv√©es (Number() pour √©viter mismatch string/number)
    const offersWithChecks = rawOffers.map(offer => ({
        ...offer,
        checks: rawChecks.filter(c => Number(c.offer_id) === Number(offer.id)),
        lastCheck: rawChecks.find(c => Number(c.offer_id) === Number(offer.id))
    }));

    // Calculer les scores par source (marchand ET comparateur)
    const calculateSourceStats = () => {
        const sourceStats = {};

        offersWithChecks.forEach(offer => {
            // Ajouter le marchand (store)
            const merchant = offer.store || 'Inconnu';
            if (!sourceStats[merchant]) {
                sourceStats[merchant] = { name: merchant, type: 'merchant', checks: 0, totalDiff: 0, diffs: [], offers: [] };
            }

            // Utiliser le champ source_comparator de l'offre
            const comparator = offer.source_comparator;
            if (comparator && !sourceStats[comparator]) {
                sourceStats[comparator] = { name: comparator, type: 'comparator', checks: 0, totalDiff: 0, diffs: [], offers: [] };
            }

            if (offer.displayed_price && offer.lastCheck?.checkout_price) {
                const diff = offer.lastCheck.checkout_price - offer.displayed_price;
                const pct = (diff / offer.displayed_price) * 100;

                // Attribuer √† la fois au marchand et au comparateur
                sourceStats[merchant].checks++;
                sourceStats[merchant].totalDiff += Math.abs(pct);
                sourceStats[merchant].diffs.push({ pct, diff, offer });
                sourceStats[merchant].offers.push(offer);

                if (comparator) {
                    sourceStats[comparator].checks++;
                    sourceStats[comparator].totalDiff += Math.abs(pct);
                    sourceStats[comparator].diffs.push({ pct, diff, offer });
                    sourceStats[comparator].offers.push(offer);
                }
            }
        });

        // Calculer score et badge pour chaque source
        return Object.values(sourceStats).map((s, i) => {
            const avgDiffPct = s.checks > 0 ? s.totalDiff / s.checks : 0;
            // Score: 100 - avgDiff (plus l'√©cart est faible, meilleur le score)
            const score = Math.max(0, Math.min(100, Math.round(100 - avgDiffPct * 2)));
            const badge = score >= 95 ? 'R√âF√âRENCE' : score >= 85 ? 'TR√àS FIABLE' : score >= 75 ? 'FIABLE' : score >= 60 ? 'VARIABLE' : score >= 40 ? 'ATTENTION' : 'RISQU√â';
            const avgDiff = s.checks > 0 ? (s.totalDiff / s.checks / 100 * (s.offers[0]?.displayed_price || 30)).toFixed(2) : 0;

            return {
                id: i + 1,
                name: s.name,
                type: s.type,
                logo: SOURCE_LOGOS[s.name] || 'üè∑Ô∏è',
                score,
                checks: s.checks,
                avgDiff: parseFloat(avgDiff),
                badge,
                trend: 'stable',
                since: '2024',
                diffs: s.diffs,
                offers: s.offers
            };
        }).sort((a, b) => b.score - a.score);
    };

    // G√©n√©rer les "arnaques" (offres avec √©cart > 10%)
    const generateBadOffers = () => {
        const bad = [];
        offersWithChecks.forEach(offer => {
            if (offer.displayed_price && offer.lastCheck?.checkout_price) {
                const diff = offer.lastCheck.checkout_price - offer.displayed_price;
                const pct = (diff / offer.displayed_price) * 100;
                if (pct > 10) {
                    bad.push({
                        id: offer.id,
                        game: offer.name || 'Jeu inconnu',
                        vendor: offer.store || 'Inconnu',
                        advertised: `${offer.displayed_price.toFixed(2)}‚Ç¨`,
                        actual: `${offer.lastCheck.checkout_price.toFixed(2)}‚Ç¨`,
                        diff: `+${pct.toFixed(0)}%`,
                        date: new Date(offer.lastCheck.check_date).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short', year: 'numeric' }),
                        type: pct > 30 ? 'bait-switch' : pct > 20 ? 'hidden-fees' : 'service-fee',
                        status: 'confirmed',
                        screenshot: offer.lastCheck.screenshot_url || offer.displayed_price_screenshot
                    });
                }
            }
        });
        return bad.sort((a, b) => parseFloat(b.diff) - parseFloat(a.diff)).slice(0, 20);
    };

    const sourceStats = calculateSourceStats();
    const vendorData = sourceStats; // Tous dans le m√™me classement (marchands + comparateurs)
    const comparatorData = sourceStats.filter(s => s.type === 'comparator');
    const merchantData = sourceStats.filter(s => s.type === 'merchant');
    const badOffers = generateBadOffers();

    // G√©n√©rer les "mauvais coupons" depuis les donn√©es Supabase
    const badCoupons = rawCoupons.filter(c => c.is_fake).map(c => ({
        id: c.id,
        code: c.code,
        vendor: c.vendor,
        promise: c.promise || '-',
        reality: c.reality || 'Ne fonctionne pas',
        game: c.game || 'Tout',
        date: c.created_at ? new Date(c.created_at).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short', year: 'numeric' }) : '-',
        source_url: c.source_url,
        notes: c.notes
    }));

    // Stats globales calcul√©es
    const stats = {
        totalChecks: rawChecks.length,
        vendorsAudited: sourceStats.length,
        comparatorsAudited: comparatorData.length,
        avgLieRate: sourceStats.length > 0 ? (sourceStats.reduce((sum, s) => sum + (100 - s.score), 0) / sourceStats.length).toFixed(1) : 0,
        badOffersExposed: badOffers.length,
        badCouponsExposed: badCoupons.length,
        lastUpdate: new Date().toLocaleString('fr-FR', { day: 'numeric', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' }),
        startedSince: 'Novembre 2024'
    };

    // Fonction pour g√©n√©rer le rapport de pr√©cision des comparateurs
    const generateReport = () => {
        const reportDate = new Date().toLocaleString('fr-FR', {
            day: 'numeric', month: 'long', year: 'numeric',
            hour: '2-digit', minute: '2-digit'
        });

        // G√©n√©rer le HTML du rapport
        const reportHTML = `<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport TPA - Pr√©cision des Comparateurs - ${reportDate}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        @media print { .no-print { display: none; } }
    </style>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl p-8">
        <div class="flex items-center justify-between mb-8 pb-6 border-b">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">üìä Rapport de Pr√©cision</h1>
                <p class="text-gray-500 mt-1">True Price Authority - Analyse des Comparateurs</p>
            </div>
            <div class="text-right">
                <p class="text-sm text-gray-500">G√©n√©r√© le</p>
                <p class="font-semibold">${reportDate}</p>
            </div>
        </div>

        <div class="grid grid-cols-3 gap-6 mb-8">
            <div class="bg-emerald-50 rounded-xl p-4 text-center">
                <p class="text-3xl font-bold text-emerald-600">${stats.totalChecks}</p>
                <p class="text-sm text-gray-600">Prix v√©rifi√©s</p>
            </div>
            <div class="bg-blue-50 rounded-xl p-4 text-center">
                <p class="text-3xl font-bold text-blue-600">${comparatorData.length}</p>
                <p class="text-sm text-gray-600">Comparateurs analys√©s</p>
            </div>
            <div class="bg-amber-50 rounded-xl p-4 text-center">
                <p class="text-3xl font-bold text-amber-600">${stats.avgLieRate}%</p>
                <p class="text-sm text-gray-600">√âcart moyen</p>
            </div>
        </div>

        <h2 class="text-xl font-bold mb-4">üéØ Classement des Comparateurs par Pr√©cision</h2>
        <p class="text-gray-600 mb-6">Comparaison des prix affich√©s (SANS coupon) vs prix r√©els au checkout</p>

        <table class="w-full mb-8">
            <thead>
                <tr class="border-b-2 border-gray-200">
                    <th class="text-left py-3 px-4">#</th>
                    <th class="text-left py-3 px-4">Comparateur</th>
                    <th class="text-center py-3 px-4">Score</th>
                    <th class="text-center py-3 px-4">V√©rifications</th>
                    <th class="text-center py-3 px-4">√âcart moyen</th>
                    <th class="text-center py-3 px-4">Badge</th>
                </tr>
            </thead>
            <tbody>
                ${comparatorData.map((c, i) => \`
                <tr class="border-b border-gray-100 \${i % 2 === 0 ? 'bg-gray-50' : ''}">
                    <td class="py-3 px-4 font-bold text-gray-400">\${i + 1}</td>
                    <td class="py-3 px-4 font-semibold">\${c.logo} \${c.name}</td>
                    <td class="py-3 px-4 text-center">
                        <span class="inline-flex items-center justify-center w-12 h-12 rounded-full \${c.score >= 95 ? 'bg-emerald-100 text-emerald-700' : c.score >= 80 ? 'bg-blue-100 text-blue-700' : c.score >= 60 ? 'bg-amber-100 text-amber-700' : 'bg-red-100 text-red-700'} font-bold">
                            \${c.score}%
                        </span>
                    </td>
                    <td class="py-3 px-4 text-center">\${c.checks}</td>
                    <td class="py-3 px-4 text-center \${c.avgDiff > 0 ? 'text-red-600' : 'text-emerald-600'}">\${c.avgDiff > 0 ? '+' : ''}\${c.avgDiff.toFixed(2)}‚Ç¨</td>
                    <td class="py-3 px-4 text-center">
                        <span class="px-3 py-1 rounded-full text-xs font-semibold \${c.score >= 95 ? 'bg-emerald-100 text-emerald-700' : c.score >= 80 ? 'bg-blue-100 text-blue-700' : c.score >= 60 ? 'bg-amber-100 text-amber-700' : 'bg-red-100 text-red-700'}">
                            \${c.badge}
                        </span>
                    </td>
                </tr>
                \`).join('')}
            </tbody>
        </table>

        <h2 class="text-xl font-bold mb-4">üìà M√©thodologie</h2>
        <div class="bg-gray-50 rounded-xl p-6 mb-8">
            <ul class="space-y-2 text-gray-600">
                <li>‚úÖ Prix relev√©s <strong>SANS coupon</strong> pour mesurer la pr√©cision r√©elle</li>
                <li>‚úÖ Comparaison avec le prix final au checkout (frais inclus)</li>
                <li>‚úÖ Score = 100 - (√©cart moyen √ó 2)</li>
                <li>‚úÖ Les coupons sont track√©s s√©par√©ment pour comparaison</li>
            </ul>
        </div>

        <div class="text-center text-gray-400 text-sm mt-8 pt-6 border-t">
            <p>Rapport g√©n√©r√© par True Price Authority</p>
            <p class="mt-1">üîó <a href="https://true-price-authority.vercel.app" class="text-emerald-600 hover:underline">true-price-authority.vercel.app</a></p>
        </div>
    </div>

    <div class="text-center mt-6 no-print">
        <button onclick="window.print()" class="px-6 py-3 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600 transition">
            üñ®Ô∏è Imprimer / Sauvegarder en PDF
        </button>
    </div>
</body>
</html>`;

        // Cr√©er et t√©l√©charger le fichier
        const blob = new Blob([reportHTML], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = \`TPA_Rapport_\${new Date().toISOString().split('T')[0]}.html\`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    };

    if (loading) {
        return (
            <div className="min-h-screen bg-gray-50 flex items-center justify-center">
                <div className="text-center">
                    <div className="w-16 h-16 bg-primary rounded-2xl flex items-center justify-center mx-auto mb-4 animate-pulse">
                        <span className="text-white font-bold text-2xl">T</span>
                    </div>
                    <p className="text-gray-500">Chargement des donn√©es...</p>
                </div>
            </div>
        );
    }

    return (
        <LangContext.Provider value={{ lang, setLang, t }}>
            <div className="min-h-screen bg-gray-50">
                <Navbar currentPage={currentPage} setCurrentPage={setCurrentPage} />
                <main>
                    {currentPage === 'home' && <HomePage setCurrentPage={setCurrentPage} vendorData={vendorData} badOffers={badOffers} stats={stats} />}
                    {currentPage === 'rankings' && <RankingsPage vendorData={vendorData} comparatorData={comparatorData} stats={stats} />}
                    {currentPage === 'bad-offers' && <BadOffersPage badOffers={badOffers} stats={stats} />}
                    {currentPage === 'bad-coupons' && <BadCouponsPage badCoupons={badCoupons} stats={stats} />}
                    {currentPage === 'about' && <AboutPage stats={stats} />}
                </main>
                <Footer stats={stats} />
            </div>
        </LangContext.Provider>
    );
}

function Navbar({ currentPage, setCurrentPage }) {
    const { lang, setLang, t } = useLang();
    return (
        <nav className="bg-white border-b border-gray-200 sticky top-0 z-50">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="flex justify-between items-center h-16">
                    <div className="flex items-center space-x-2 cursor-pointer" onClick={() => setCurrentPage('home')}>
                        <div className="w-10 h-10 bg-primary rounded-lg flex items-center justify-center">
                            <span className="text-white font-bold text-xl">T</span>
                        </div>
                        <div>
                            <span className="font-bold text-lg text-gray-900">True Price</span>
                            <span className="font-light text-lg text-primary ml-1">Authority</span>
                        </div>
                    </div>

                    <div className="hidden md:flex items-center space-x-1">
                        {[
                            { id: 'home', labelKey: 'home', icon: 'fa-home' },
                            { id: 'rankings', labelKey: 'rankings', icon: 'fa-trophy' },
                            { id: 'bad-offers', labelKey: 'scams', icon: 'fa-exclamation-triangle' },
                            { id: 'bad-coupons', labelKey: 'fakeCoupons', icon: 'fa-ticket' },
                            { id: 'about', labelKey: 'about', icon: 'fa-info-circle' },
                        ].map(item => (
                            <button
                                key={item.id}
                                onClick={() => setCurrentPage(item.id)}
                                className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${
                                    currentPage === item.id
                                        ? 'bg-primary text-white'
                                        : 'text-gray-600 hover:bg-gray-100'
                                }`}
                            >
                                <i className={`fas ${item.icon} mr-2`}></i>
                                {t(item.labelKey)}
                            </button>
                        ))}
                    </div>

                    <div className="flex items-center space-x-3">
                        {/* Language Switcher */}
                        <select
                            value={lang}
                            onChange={(e) => setLang(e.target.value)}
                            className="bg-gray-100 border-0 rounded-lg px-2 py-1 text-sm font-medium text-gray-700 cursor-pointer hover:bg-gray-200 transition"
                        >
                            <option value="fr">üá´üá∑ FR</option>
                            <option value="en">üá¨üáß EN</option>
                        </select>
                        {isDemoMode() && (
                            <span className="px-3 py-1 bg-orange-100 text-orange-600 rounded-full text-xs font-semibold">
                                <i className="fas fa-flask mr-1"></i>{t('demoMode')}
                            </span>
                        )}
                        <a href="#" className="text-gray-400 hover:text-gray-600 transition"><i className="fab fa-twitter text-lg"></i></a>
                        <a href="#" className="text-gray-400 hover:text-gray-600 transition"><i className="fab fa-discord text-lg"></i></a>
                        <a href="#" className="text-gray-400 hover:text-gray-600 transition"><i className="fab fa-youtube text-lg"></i></a>
                    </div>
                </div>
            </div>
        </nav>
    );
}

function HomePage({ setCurrentPage, vendorData, badOffers, stats }) {
    const { t } = useLang();
    return (
        <>
            {/* Hero Section */}
            <section className="gradient-hero py-20">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div className="grid lg:grid-cols-2 gap-12 items-center">
                        <div>
                            <div className="inline-flex items-center px-3 py-1 rounded-full bg-primary/10 text-primary text-sm font-medium mb-6">
                                <i className="fas fa-shield-alt mr-2"></i>
                                {t('heroTagline')} {stats.startedSince}
                            </div>
                            <h1 className="text-4xl lg:text-5xl font-bold text-gray-900 leading-tight mb-6">
                                {t('heroTitle1')}
                                <span className="text-primary"> {t('heroTitle2')}</span>
                            </h1>
                            <p className="text-xl text-gray-600 mb-8">
                                {t('heroDesc')}
                            </p>
                            <div className="flex flex-wrap gap-4">
                                <button onClick={() => setCurrentPage('rankings')} className="px-6 py-3 bg-primary text-white font-semibold rounded-lg hover:bg-primary/90 transition shadow-lg shadow-primary/30">
                                    <i className="fas fa-trophy mr-2"></i>
                                    {t('viewRankings')}
                                </button>
                                <button onClick={() => setCurrentPage('bad-offers')} className="px-6 py-3 bg-white text-gray-700 font-semibold rounded-lg hover:bg-gray-50 transition border border-gray-200">
                                    <i className="fas fa-search mr-2"></i>
                                    {t('exposedOffers')}
                                </button>
                            </div>
                        </div>

                        <div className="relative">
                            {/* Lie Barometer */}
                            <div className="bg-white rounded-2xl shadow-xl p-8 card-hover">
                                <div className="text-center mb-6">
                                    <h3 className="text-lg font-semibold text-gray-700 mb-2">{t('lieBarometer')}</h3>
                                    <p className="text-sm text-gray-500">{t('lieDesc')}</p>
                                </div>
                                <div className="relative w-48 h-48 mx-auto mb-6">
                                    <div className="trust-ring w-full h-full p-4" style={{'--percent': `${100-stats.avgLieRate}%`}}>
                                        <div className="w-full h-full bg-white rounded-full flex items-center justify-center flex-col">
                                            <span className="text-4xl font-bold text-danger">{stats.avgLieRate}%</span>
                                            <span className="text-sm text-gray-500">{t('lying')}</span>
                                        </div>
                                    </div>
                                </div>
                                <div className="h-3 lie-meter rounded-full mb-4"></div>
                                <div className="flex justify-between text-xs text-gray-500">
                                    <span>{t('honest')}</span>
                                    <span>{t('deceiving')}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            {/* Stats Bar */}
            <section className="bg-secondary py-8">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div className="grid grid-cols-2 md:grid-cols-5 gap-8 text-center">
                        {[
                            { value: stats.totalChecks.toLocaleString(), labelKey: 'pricesVerified', icon: 'fa-check-circle' },
                            { value: stats.vendorsAudited, labelKey: 'vendorsAudited', icon: 'fa-store' },
                            { value: stats.badOffersExposed, labelKey: 'scamsExposed', icon: 'fa-exclamation-triangle' },
                            { value: stats.badCouponsExposed, labelKey: 'fakeCouponsCount', icon: 'fa-ticket' },
                            { value: '73.1%', labelKey: 'avgReliability', icon: 'fa-chart-line' },
                        ].map((stat, i) => (
                            <div key={i}>
                                <div className="text-3xl font-bold text-white mb-1">{stat.value}</div>
                                <div className="text-gray-400 text-sm">
                                    <i className={`fas ${stat.icon} mr-1`}></i>{t(stat.labelKey)}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            </section>

            {/* Top Vendors Preview */}
            <section className="py-16">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div className="text-center mb-12">
                        <h2 className="text-3xl font-bold text-gray-900 mb-4">
                            <i className="fas fa-trophy text-primary mr-3"></i>
                            Classement de Confiance
                        </h2>
                        <p className="text-gray-600 max-w-2xl mx-auto">
                            Bas√© sur {stats.totalChecks.toLocaleString()} v√©rifications de prix.
                            Nous comparons le prix affich√© sur les comparateurs avec le prix r√©el au checkout.
                        </p>
                    </div>

                    <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        {vendorData.slice(0, 4).map((vendor, i) => (
                            <VendorCard key={vendor.id} vendor={vendor} rank={i + 1} />
                        ))}
                    </div>

                    <div className="text-center mt-8">
                        <button onClick={() => setCurrentPage('rankings')} className="text-primary font-semibold hover:underline">
                            Voir le classement complet <i className="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
            </section>

            {/* Recent Bad Offers */}
            <section className="py-16 bg-gray-100">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div className="text-center mb-12">
                        <h2 className="text-3xl font-bold text-gray-900 mb-4">
                            <i className="fas fa-exclamation-triangle text-danger mr-3"></i>
                            Derni√®res Arnaques Expos√©es
                        </h2>
                        <p className="text-gray-600">Prix trompeurs d√©tect√©s ces derniers jours</p>
                    </div>

                    <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {badOffers.slice(0, 3).map(offer => (
                            <BadOfferCard key={offer.id} offer={offer} />
                        ))}
                    </div>

                    <div className="text-center mt-8">
                        <button onClick={() => setCurrentPage('bad-offers')} className="text-danger font-semibold hover:underline">
                            Voir toutes les arnaques <i className="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
            </section>

            {/* How It Works */}
            <section className="py-16">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div className="text-center mb-12">
                        <h2 className="text-3xl font-bold text-gray-900 mb-4">Comment √ßa marche ?</h2>
                        <p className="text-gray-600">Notre m√©thodologie de v√©rification</p>
                    </div>

                    <div className="grid md:grid-cols-4 gap-8">
                        {[
                            { step: '01', title: 'Collecte', desc: 'Nous relevons les prix affich√©s sur Allkeyshop et GG.deals', icon: 'fa-search' },
                            { step: '02', title: 'V√©rification', desc: 'Nous allons jusqu\'au checkout sur chaque marchand', icon: 'fa-shopping-cart' },
                            { step: '03', title: 'Comparaison', desc: 'Nous calculons l\'√©cart entre prix affich√© et prix r√©el', icon: 'fa-balance-scale' },
                            { step: '04', title: 'Publication', desc: 'Nous publions les r√©sultats et alertons la communaut√©', icon: 'fa-bullhorn' },
                        ].map((item, i) => (
                            <div key={i} className="text-center">
                                <div className="w-16 h-16 bg-primary/10 rounded-2xl flex items-center justify-center mx-auto mb-4">
                                    <i className={`fas ${item.icon} text-2xl text-primary`}></i>
                                </div>
                                <div className="text-xs text-primary font-bold mb-2">√âTAPE {item.step}</div>
                                <h3 className="font-semibold text-gray-900 mb-2">{item.title}</h3>
                                <p className="text-sm text-gray-600">{item.desc}</p>
                            </div>
                        ))}
                    </div>
                </div>
            </section>

            {/* CTA */}
            <section className="py-16 bg-primary">
                <div className="max-w-4xl mx-auto px-4 text-center">
                    <h2 className="text-3xl font-bold text-white mb-4">Rejoignez la communaut√©</h2>
                    <p className="text-white/80 mb-8">Suivez-nous pour √™tre alert√© des nouvelles arnaques d√©tect√©es</p>
                    <div className="flex justify-center space-x-4">
                        <a href="#" className="px-6 py-3 bg-white text-primary font-semibold rounded-lg hover:bg-gray-100 transition">
                            <i className="fab fa-twitter mr-2"></i>Twitter
                        </a>
                        <a href="#" className="px-6 py-3 bg-white/10 text-white font-semibold rounded-lg hover:bg-white/20 transition border border-white/30">
                            <i className="fab fa-discord mr-2"></i>Discord
                        </a>
                        <a href="#" className="px-6 py-3 bg-white/10 text-white font-semibold rounded-lg hover:bg-white/20 transition border border-white/30">
                            <i className="fab fa-youtube mr-2"></i>YouTube
                        </a>
                    </div>
                </div>
            </section>
        </>
    );
}

function VendorCard({ vendor, rank }) {
    const getBadgeStyle = (score) => {
        if (score >= 95) return 'badge-honest';
        if (score >= 85) return 'badge-reliable';
        if (score >= 70) return 'badge-correct';
        return 'badge-warning';
    };

    const getTrendIcon = (trend) => {
        if (trend === 'up') return <i className="fas fa-arrow-up text-green-500"></i>;
        if (trend === 'down') return <i className="fas fa-arrow-down text-red-500"></i>;
        return <i className="fas fa-minus text-gray-400"></i>;
    };

    return (
        <div className="bg-white rounded-xl shadow-md p-6 card-hover border border-gray-100">
            <div className="flex items-start justify-between mb-4">
                <div className="flex items-center space-x-3">
                    <div className="text-3xl">{vendor.logo}</div>
                    <div>
                        <div className="font-semibold text-gray-900">{vendor.name}</div>
                        <div className="text-xs text-gray-500">{vendor.checks} v√©rifications</div>
                    </div>
                </div>
                <div className="text-2xl font-bold text-gray-300">#{rank}</div>
            </div>

            <div className="flex items-center justify-between mb-3">
                <div className="text-3xl font-bold text-gray-900">{vendor.score}%</div>
                <span className={`px-3 py-1 rounded-full text-white text-xs font-semibold ${getBadgeStyle(vendor.score)}`}>
                    {vendor.badge}
                </span>
            </div>

            <div className="flex items-center justify-between text-sm">
                <span className="text-gray-500">√âcart moyen: <strong className={vendor.avgDiff > 1 ? 'text-red-500' : 'text-green-500'}>+{vendor.avgDiff}‚Ç¨</strong></span>
                <span>{getTrendIcon(vendor.trend)}</span>
            </div>
        </div>
    );
}

function BadOfferCard({ offer }) {
    const getTypeLabel = (type) => {
        const types = {
            'bait-switch': { label: 'Bait & Switch', color: 'bg-red-100 text-red-700' },
            'hidden-fees': { label: 'Frais cach√©s', color: 'bg-orange-100 text-orange-700' },
            'currency-trick': { label: 'Astuce devise', color: 'bg-yellow-100 text-yellow-700' },
            'service-fee': { label: 'Frais de service', color: 'bg-purple-100 text-purple-700' },
        };
        return types[type] || { label: type, color: 'bg-gray-100 text-gray-700' };
    };

    const typeInfo = getTypeLabel(offer.type);

    return (
        <div className="bg-white rounded-xl shadow-md p-6 card-hover border-l-4 border-red-500">
            <div className="flex items-start justify-between mb-3">
                <span className={`px-2 py-1 rounded text-xs font-medium ${typeInfo.color}`}>
                    {typeInfo.label}
                </span>
                <span className="text-xs text-gray-400">{offer.date}</span>
            </div>
            <h3 className="font-semibold text-gray-900 mb-2">{offer.game}</h3>
            <div className="text-sm text-gray-600 mb-3">sur <strong>{offer.vendor}</strong></div>
            <div className="flex items-center justify-between bg-red-50 rounded-lg p-3">
                <div className="text-center">
                    <div className="text-xs text-gray-500">Affich√©</div>
                    <div className="font-semibold line-through text-gray-400">{offer.advertised}</div>
                </div>
                <i className="fas fa-arrow-right text-red-400"></i>
                <div className="text-center">
                    <div className="text-xs text-gray-500">R√©el</div>
                    <div className="font-bold text-red-600">{offer.actual}</div>
                </div>
                <div className="text-center">
                    <div className="text-xs text-gray-500">√âcart</div>
                    <div className="font-bold text-red-600">{offer.diff}</div>
                </div>
            </div>
        </div>
    );
}

function RankingsPage({ vendorData, comparatorData, stats }) {
    const [selectedVendor, setSelectedVendor] = useState(null);

    return (
        <section className="py-12">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

                {/* Section Comparateurs */}
                <div className="mb-12">
                    <div className="mb-6">
                        <h1 className="text-3xl font-bold text-gray-900 mb-2">
                            <i className="fas fa-search-dollar text-blue-500 mr-3"></i>
                            Classement des Comparateurs
                        </h1>
                        <p className="text-gray-600">Les agr√©gateurs de prix que nous utilisons comme source</p>
                    </div>

                    <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        {comparatorData.map((comp, i) => (
                            <div key={comp.id} className="bg-white rounded-xl shadow-md p-6 card-hover border border-blue-100 relative">
                                <div className="absolute -top-3 -left-3 w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-sm">
                                    #{i + 1}
                                </div>
                                <div className="flex items-center space-x-3 mb-4">
                                    <div className="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden">
                                        <span className="text-2xl">üîç</span>
                                    </div>
                                    <div>
                                        <div className="font-semibold text-gray-900">{comp.name}</div>
                                        <div className="text-xs text-gray-500">{comp.checks} v√©rifications</div>
                                    </div>
                                </div>
                                <div className="flex items-center justify-between mb-3">
                                    <div className="text-2xl font-bold text-blue-600">{comp.score}%</div>
                                    <span className={`px-2 py-1 rounded-full text-white text-xs font-semibold ${
                                        comp.score >= 95 ? 'badge-honest' :
                                        comp.score >= 85 ? 'badge-reliable' :
                                        comp.score >= 70 ? 'badge-correct' : 'badge-warning'
                                    }`}>{comp.badge}</span>
                                </div>
                                <p className="text-xs text-gray-500 mb-2">{comp.desc}</p>
                                <div className="flex items-center justify-between text-xs">
                                    <span className="text-gray-500">√âcart: <strong className="text-green-500">+{comp.avgDiff}‚Ç¨</strong></span>
                                    {comp.trend === 'up' && <i className="fas fa-arrow-up text-green-500"></i>}
                                    {comp.trend === 'down' && <i className="fas fa-arrow-down text-red-500"></i>}
                                    {comp.trend === 'stable' && <i className="fas fa-minus text-gray-400"></i>}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>

                {/* Section Revendeurs */}
                <div className="mb-8">
                    <h2 className="text-3xl font-bold text-gray-900 mb-2">
                        <i className="fas fa-trophy text-primary mr-3"></i>
                        Classement des Revendeurs
                    </h2>
                    <p className="text-gray-600">Mis √† jour le {stats.lastUpdate} ‚Ä¢ {stats.vendorsAudited} marchands audit√©s</p>
                </div>

                <div className="bg-white rounded-xl shadow-lg overflow-hidden">
                    <table className="w-full">
                        <thead className="bg-gray-50 border-b">
                            <tr>
                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-600">Rang</th>
                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-600">Vendeur</th>
                                <th className="px-6 py-4 text-center text-sm font-semibold text-gray-600">Score</th>
                                <th className="px-6 py-4 text-center text-sm font-semibold text-gray-600">V√©rifications</th>
                                <th className="px-6 py-4 text-center text-sm font-semibold text-gray-600">√âcart moyen</th>
                                <th className="px-6 py-4 text-center text-sm font-semibold text-gray-600">Badge</th>
                                <th className="px-6 py-4 text-center text-sm font-semibold text-gray-600">Preuve</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-100">
                            {vendorData.map((vendor, i) => (
                                <tr key={vendor.id} className="hover:bg-gray-50 transition">
                                    <td className="px-6 py-4">
                                        <span className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${
                                            i === 0 ? 'bg-yellow-100 text-yellow-700' :
                                            i === 1 ? 'bg-gray-100 text-gray-600' :
                                            i === 2 ? 'bg-orange-100 text-orange-700' : 'bg-gray-50 text-gray-500'
                                        }`}>
                                            {i + 1}
                                        </span>
                                    </td>
                                    <td className="px-6 py-4">
                                        <div className="flex items-center space-x-3">
                                            <span className="text-2xl">{vendor.logo}</span>
                                            <div>
                                                <div className="font-semibold text-gray-900">{vendor.name}</div>
                                                <div className="text-xs text-gray-500">Suivi depuis {vendor.since}</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td className="px-6 py-4 text-center">
                                        <span className={`text-2xl font-bold ${
                                            vendor.score >= 90 ? 'text-green-600' :
                                            vendor.score >= 70 ? 'text-yellow-600' : 'text-red-600'
                                        }`}>{vendor.score}%</span>
                                    </td>
                                    <td className="px-6 py-4 text-center text-gray-600">{vendor.checks.toLocaleString()}</td>
                                    <td className="px-6 py-4 text-center">
                                        <span className={vendor.avgDiff > 1 ? 'text-red-600 font-semibold' : 'text-green-600'}>
                                            +{vendor.avgDiff}‚Ç¨
                                        </span>
                                    </td>
                                    <td className="px-6 py-4 text-center">
                                        <span className={`px-3 py-1 rounded-full text-xs font-semibold text-white ${
                                            vendor.score >= 95 ? 'badge-honest' :
                                            vendor.score >= 85 ? 'badge-reliable' :
                                            vendor.score >= 70 ? 'badge-correct' : 'badge-warning'
                                        }`}>{vendor.badge}</span>
                                    </td>
                                    <td className="px-6 py-4 text-center">
                                        {vendor.screenshot ? (
                                            <button
                                                onClick={() => setSelectedVendor(vendor)}
                                                className="px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-medium hover:bg-blue-200 transition"
                                            >
                                                <i className="fas fa-image mr-1"></i>Voir
                                            </button>
                                        ) : (
                                            <span className="text-gray-400 text-xs">-</span>
                                        )}
                                    </td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>

                {/* Modal Screenshot */}
                {selectedVendor && (
                    <div className="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4" onClick={() => setSelectedVendor(null)}>
                        <div className="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-auto" onClick={e => e.stopPropagation()}>
                            <div className="p-4 border-b flex items-center justify-between">
                                <div>
                                    <h3 className="font-semibold text-lg">{selectedVendor.name}</h3>
                                    <p className="text-sm text-gray-500">Screenshot de v√©rification de prix</p>
                                </div>
                                <button onClick={() => setSelectedVendor(null)} className="p-2 hover:bg-gray-100 rounded-lg">
                                    <i className="fas fa-times text-gray-500"></i>
                                </button>
                            </div>
                            <div className="p-4">
                                <img src={selectedVendor.screenshot} alt={`Screenshot ${selectedVendor.name}`} className="w-full rounded-lg shadow-lg" />
                            </div>
                        </div>
                    </div>
                )}
            </div>
        </section>
    );
}

function BadOffersPage({ badOffers, stats }) {
    return (
        <section className="py-12">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="mb-8">
                    <h1 className="text-3xl font-bold text-gray-900 mb-2">
                        <i className="fas fa-exclamation-triangle text-danger mr-3"></i>
                        Offres Trompeuses Expos√©es
                    </h1>
                    <p className="text-gray-600">{stats.badOffersExposed} cas document√©s</p>
                </div>

                <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {badOffers.map(offer => (
                        <BadOfferCard key={offer.id} offer={offer} />
                    ))}
                </div>
            </div>
        </section>
    );
}

function BadCouponsPage({ badCoupons, stats }) {
    return (
        <section className="py-12">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="mb-8">
                    <h1 className="text-3xl font-bold text-gray-900 mb-2">
                        <i className="fas fa-ticket text-warning mr-3"></i>
                        Faux Coupons & Codes Trompeurs
                    </h1>
                    <p className="text-gray-600">{stats.badCouponsExposed} codes analys√©s</p>
                </div>

                <div className="bg-white rounded-xl shadow-lg overflow-hidden">
                    <table className="w-full">
                        <thead className="bg-gray-50 border-b">
                            <tr>
                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-600">Code</th>
                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-600">Vendeur</th>
                                <th className="px-6 py-4 text-center text-sm font-semibold text-gray-600">Promesse</th>
                                <th className="px-6 py-4 text-center text-sm font-semibold text-gray-600">R√©alit√©</th>
                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-600">Applicable sur</th>
                                <th className="px-6 py-4 text-center text-sm font-semibold text-gray-600">Date</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-100">
                            {badCoupons.map(coupon => (
                                <tr key={coupon.id} className="hover:bg-red-50 transition">
                                    <td className="px-6 py-4">
                                        <code className="px-2 py-1 bg-gray-100 rounded font-mono text-sm">{coupon.code}</code>
                                    </td>
                                    <td className="px-6 py-4 font-medium text-gray-900">{coupon.vendor}</td>
                                    <td className="px-6 py-4 text-center">
                                        <span className="text-green-600 font-semibold">{coupon.promise}</span>
                                    </td>
                                    <td className="px-6 py-4 text-center">
                                        <span className="text-red-600 font-semibold">{coupon.reality}</span>
                                    </td>
                                    <td className="px-6 py-4 text-gray-600">{coupon.game}</td>
                                    <td className="px-6 py-4 text-center text-gray-500 text-sm">{coupon.date}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    );
}

function AboutPage({ stats }) {
    return (
        <section className="py-12">
            <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <h1 className="text-3xl font-bold text-gray-900 mb-8">√Ä propos de True Price Authority</h1>

                <div className="prose prose-lg max-w-none">
                    <div className="bg-primary/5 rounded-xl p-6 mb-8">
                        <h2 className="text-xl font-semibold text-gray-900 mb-4">Notre mission</h2>
                        <p className="text-gray-600">
                            True Price Authority est n√© d'un constat simple : les comparateurs de prix de cl√©s de jeux vid√©o
                            affichent souvent des prix qui ne correspondent pas √† la r√©alit√©. Frais cach√©s, frais de service,
                            conversions de devises abusives... Les joueurs se font r√©guli√®rement avoir.
                        </p>
                    </div>

                    <h2 className="text-xl font-semibold text-gray-900 mb-4">Ce que nous faisons</h2>
                    <ul className="space-y-3 text-gray-600 mb-8">
                        <li className="flex items-start">
                            <i className="fas fa-check text-primary mt-1 mr-3"></i>
                            <span>V√©rification manuelle des prix r√©els au checkout</span>
                        </li>
                        <li className="flex items-start">
                            <i className="fas fa-check text-primary mt-1 mr-3"></i>
                            <span>Documentation des pratiques trompeuses</span>
                        </li>
                        <li className="flex items-start">
                            <i className="fas fa-check text-primary mt-1 mr-3"></i>
                            <span>Classement objectif des revendeurs par fiabilit√©</span>
                        </li>
                        <li className="flex items-start">
                            <i className="fas fa-check text-primary mt-1 mr-3"></i>
                            <span>Alerte de la communaut√© sur les arnaques d√©tect√©es</span>
                        </li>
                    </ul>

                    <h2 className="text-xl font-semibold text-gray-900 mb-4">Ind√©pendance</h2>
                    <p className="text-gray-600 mb-8">
                        True Price Authority n'est affili√© √† aucun revendeur. Nous n'acceptons aucune r√©mun√©ration
                        des sites que nous auditons. Notre seul objectif est de prot√©ger les consommateurs.
                    </p>

                    <h2 className="text-xl font-semibold text-gray-900 mb-4">Contact</h2>
                    <p className="text-gray-600">
                        Pour signaler une arnaque ou nous contacter, rejoignez notre Discord ou suivez-nous sur Twitter.
                    </p>
                </div>
            </div>
        </section>
    );
}

function Footer({ stats }) {
    return (
        <footer className="bg-secondary py-12">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="grid md:grid-cols-4 gap-8 mb-8">
                    <div>
                        <div className="flex items-center space-x-2 mb-4">
                            <div className="w-8 h-8 bg-primary rounded-lg flex items-center justify-center">
                                <span className="text-white font-bold">T</span>
                            </div>
                            <span className="font-bold text-white">True Price Authority</span>
                        </div>
                        <p className="text-gray-400 text-sm">
                            Le barom√®tre de confiance des revendeurs de cl√©s de jeux vid√©o.
                        </p>
                    </div>
                    <div>
                        <h4 className="font-semibold text-white mb-4">Navigation</h4>
                        <ul className="space-y-2 text-gray-400 text-sm">
                            <li><a href="#" className="hover:text-white transition">Accueil</a></li>
                            <li><a href="#" className="hover:text-white transition">Classement</a></li>
                            <li><a href="#" className="hover:text-white transition">Arnaques expos√©es</a></li>
                            <li><a href="#" className="hover:text-white transition">Faux coupons</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 className="font-semibold text-white mb-4">Ressources</h4>
                        <ul className="space-y-2 text-gray-400 text-sm">
                            <li><a href="#" className="hover:text-white transition">M√©thodologie</a></li>
                            <li><a href="#" className="hover:text-white transition">FAQ</a></li>
                            <li><a href="#" className="hover:text-white transition">Signaler une arnaque</a></li>
                            <li><a href="#" className="hover:text-white transition">API (bient√¥t)</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 className="font-semibold text-white mb-4">Communaut√©</h4>
                        <div className="flex space-x-4">
                            <a href="#" className="w-10 h-10 bg-gray-700 rounded-lg flex items-center justify-center text-gray-400 hover:bg-primary hover:text-white transition">
                                <i className="fab fa-twitter"></i>
                            </a>
                            <a href="#" className="w-10 h-10 bg-gray-700 rounded-lg flex items-center justify-center text-gray-400 hover:bg-primary hover:text-white transition">
                                <i className="fab fa-discord"></i>
                            </a>
                            <a href="#" className="w-10 h-10 bg-gray-700 rounded-lg flex items-center justify-center text-gray-400 hover:bg-primary hover:text-white transition">
                                <i className="fab fa-youtube"></i>
                            </a>
                            <a href="#" className="w-10 h-10 bg-gray-700 rounded-lg flex items-center justify-center text-gray-400 hover:bg-primary hover:text-white transition">
                                <i className="fab fa-reddit"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div className="border-t border-gray-700 pt-8 text-center text-gray-500 text-sm">
                    <p>¬© 2024-2026 True Price Authority. Non affili√© aux revendeurs audit√©s.</p>
                    <p className="mt-2">Derni√®re mise √† jour : {stats.lastUpdate}</p>
                </div>
            </div>
        </footer>
    );
}

ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>